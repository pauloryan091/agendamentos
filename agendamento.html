<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agendamentos - Sistema de Agendamento</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Ajustes da tabela e formulário inline */
    .form-inline {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1.5rem;
    }
    .form-inline input, .form-inline select, .form-inline button {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 0.9rem;
    }
    .table-actions button {
      margin-right: 5px;
    }
    @media(max-width: 680px){
      .form-inline {
        flex-direction: column;
        align-items: stretch;
      }
    }
  </style>
</head>
<body>

<header>
  <div class="container header-content">
    <a href="#" class="logo">Agendamento+</a>
    <button id="menuBtn" aria-label="Abrir menu">☰</button>
    <nav class="nav-links" id="menu">
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="serviços.html" class="nav-link">Serviços</a>
      <a href="agendamento.html" class="nav-link active">Agendamentos</a>
      <a href="clientes.html" class="nav-link">Clientes</a>
      <a href="perfil.html" class="nav-link">Perfil</a>
    </nav>
  </div>
</header>

<main class="main-content container">
  <section class="section">
    <h2 class="section-title">Agendamentos</h2>

    <div class="form-inline">
      <input type="date" id="filtroData" class="form-control" aria-label="Filtrar por data">
      <button class="btn btn-primary" onclick="filtrarAgendamentos()">Filtrar</button>
      <button class="btn btn-secondary" onclick="limparFiltro()">Limpar Filtro</button>
      <select id="selectAgendamento" aria-label="Selecionar agendamento">
        <option value="">Selecione um agendamento</option>
      </select>
      <button class="btn btn-success" onclick="editarSelecionado()">Editar</button>
      <button class="btn btn-danger" onclick="cancelarSelecionado()">Cancelar</button>
    </div>

    <div class="table-responsive">
      <table class="table table-striped" id="tabelaAgendamentos">
        <thead>
          <tr>
            <th>Cliente</th>
            <th>Serviço</th>
            <th>Valor</th>
            <th>Data</th>
            <th>Hora</th>
          </tr>
        </thead>
        <tbody id="corpoTabela">
                </tbody>
        </table>
    </section>
</main>

<footer class="footer section">
  <div class="container footer-content">
    <div class="footer-brand">
      <a href="#" class="logo">Agendamento+</a>
      <p>Sistema de Agendamento Online</p>
    </div>
    <nav class="footer-nav">
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="serviços.html" class="nav-link">Serviços</a>
      <a href="agendamento.html" class="nav-link">Agendamentos</a>
      <a href="clientes.html" class="nav-link">Clientes</a>
      <a href="perfil.html" class="nav-link">Perfil</a>
    </nav>
    <div class="footer-social">
      <a href="https://www.instagram.com/pauloryantomaz/" target="_blank" class="footer-link">Instagram</a>
      <a href="https://wa.me/5561985825956" target="_blank" class="footer-link">WhatsApp</a>
    </div>
  </div>
  <div class="footer-copy">
    <p>&copy; 2025 Agendamento+. Todos os direitos reservados.</p>
  </div>
</footer>

<script >
  document.addEventListener("DOMContentLoaded", () => {
  const menuBtn = document.getElementById("menuBtn");
  const menu = document.getElementById("menu");

  menuBtn.addEventListener("click", () => {
    menu.classList.toggle("show");
  });
});

 // ======================================
// Dados iniciais
// ======================================
let agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [
  {id:1, cliente:"João Silva", servico:"Corte de Cabelo", valor:50, data:"2025-10-06", hora:"14:00"},
  {id:2, cliente:"Maria Santos", servico:"Manicure", valor:30, data:"2025-10-07", hora:"10:00"},
  {id:3, cliente:"Pedro Oliveira", servico:"Depilação", valor:70, data:"2025-10-06", hora:"16:00"}
];

// ======================================
// Elementos DOM
// ======================================
const corpoTabela = document.getElementById("corpoTabela");
const selectAgendamento = document.getElementById("selectAgendamento");
const filtroData = document.getElementById("filtroData");
const formAgendamento = document.getElementById("formAgendamento");

// ======================================
// Funções de renderização
// ======================================
function salvarLocalStorage() {
  localStorage.setItem("agendamentos", JSON.stringify(agendamentos));
}

function mostrarAgendamentos(lista) {
  corpoTabela.innerHTML = "";
  selectAgendamento.innerHTML = `<option value="">Selecione um agendamento</option>`;

  if(lista.length === 0){
    corpoTabela.innerHTML = `<tr><td colspan="5" style="text-align:center;">Nenhum agendamento encontrado.</td></tr>`;
    return;
  }

  lista.forEach(a => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${a.cliente}</td>
      <td>${a.servico}</td>
      <td>R$ ${a.valor.toFixed(2)}</td>
      <td>${a.data}</td>
      <td>${a.hora}</td>
    `;
    corpoTabela.appendChild(row);

    const opt = document.createElement("option");
    opt.value = a.id;
    opt.textContent = `${a.cliente} - ${a.servico} (${a.data} ${a.hora})`;
    selectAgendamento.appendChild(opt);
  });
}

// ======================================
// Filtrar e limpar filtro
// ======================================
function filtrarAgendamentos() {
  const data = filtroData.value;
  if(!data) return mostrarAgendamentos(agendamentos);
  const filtrados = agendamentos.filter(a => a.data === data);
  mostrarAgendamentos(filtrados);
}

function limparFiltro() {
  filtroData.value = "";
  mostrarAgendamentos(agendamentos);
}

// ======================================
// Editar / Cancelar
// ======================================
function editarSelecionado() {
  const id = parseInt(selectAgendamento.value);
  if(!id) return alert("Selecione um agendamento!");

  const agendamento = agendamentos.find(a => a.id === id);
  if(!agendamento) return;

  const novoCliente = prompt("Nome do cliente:", agendamento.cliente);
  const novoServico = prompt("Serviço:", agendamento.servico);
  const novoValor = parseFloat(prompt("Valor:", agendamento.valor));
  const novaData = prompt("Data (YYYY-MM-DD):", agendamento.data);
  const novaHora = prompt("Hora (HH:MM):", agendamento.hora);

  if(novoCliente && novoServico && !isNaN(novoValor) && novaData && novaHora){
    agendamento.cliente = novoCliente;
    agendamento.servico = novoServico;
    agendamento.valor = novoValor;
    agendamento.data = novaData;
    agendamento.hora = novaHora;

    salvarLocalStorage();
    filtrarAgendamentos();
    alert("Agendamento atualizado com sucesso!");
  } else {
    alert("Valores inválidos. Edição cancelada.");
  }
}

function cancelarSelecionado() {
  const id = parseInt(selectAgendamento.value);
  if(!id) return alert("Selecione um agendamento!");

  if(confirm("Deseja realmente cancelar este agendamento?")) {
    agendamentos = agendamentos.filter(a => a.id !== id);
    salvarLocalStorage();
    filtrarAgendamentos();
  }
}

// ======================================
// Adicionar novo agendamento
// ======================================
formAgendamento.addEventListener("submit", function(e){
  e.preventDefault();

  const cliente = this.cliente.value;
  const servico = this.servico.value;
  const valor = parseFloat(this.valor.value);
  const data = this.data.value;
  const hora = this.hora.value;

  const id = agendamentos.length ? Math.max(...agendamentos.map(a => a.id)) + 1 : 1;

  agendamentos.push({id, cliente, servico, valor, data, hora});
  salvarLocalStorage();
  mostrarAgendamentos(agendamentos);

  this.reset();
});

// ======================================
// Inicialização
// ======================================
document.addEventListener("DOMContentLoaded", () => {
  mostrarAgendamentos(agendamentos);

  // Menu Hamburger
  const menuBtn = document.getElementById("menuBtn");
  const menu = document.querySelector(".nav-links");
  menuBtn && menuBtn.addEventListener("click", () => menu.classList.toggle("show"));
});

</script>

</body>
</html>
